<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON转代码工具</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .input-section {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }
        textarea {
            width: 100%;
            height: 200px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            font-size: 14px;
            resize: vertical;
        }
        .options-section {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .select-group {
            flex: 1;
            min-width: 200px;
        }
        select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #0056b3;
        }
        .output-section {
            margin-top: 20px;
        }
        pre {
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            overflow-x: auto;
            max-height: 500px;
            margin: 0;
        }
        code {
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }
        .error {
            color: #dc3545;
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
        }
        .success {
            color: #155724;
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
        }
        .hidden {
            display: none;
        }
        @media (max-width: 768px) {
            .options-section {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>JSON转代码工具</h1>
        
        <div class="input-section">
            <label for="jsonInput">请输入JSON数据：</label>
            <textarea id="jsonInput" placeholder='{"name": "张三", "age": 25, "address": {"city": "北京", "district": "朝阳区"}}'>{"name": "张三", "age": 25, "address": {"city": "北京", "district": "朝阳区"}}</textarea>
        </div>
        
        <div class="options-section">
            <div class="select-group">
                <label for="targetLanguage">目标语言：</label>
                <select id="targetLanguage">
                    <option value="java">Java实体类</option>
                    <option value="swift">Swift结构体</option>
                    <option value="kotlin">Kotlin数据类</option>
                    <option value="typescript">TypeScript接口</option>
                    <option value="csharp">C#类</option>
                    <option value="python">Python类</option>
                </select>
            </div>
            
            <div class="select-group">
                <label for="className">类名：</label>
                <input type="text" id="className" value="User" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
            </div>
        </div>
        
        <button id="generateBtn">生成代码</button>
        
        <div id="messageContainer"></div>
        
        <div class="output-section">
            <label for="codeOutput">生成的代码：</label>
            <pre><code id="codeOutput">请选择目标语言并点击生成按钮</code></pre>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const jsonInput = document.getElementById('jsonInput');
            const targetLanguage = document.getElementById('targetLanguage');
            const className = document.getElementById('className');
            const generateBtn = document.getElementById('generateBtn');
            const codeOutput = document.getElementById('codeOutput');
            const messageContainer = document.getElementById('messageContainer');
            
            // 生成代码按钮点击事件
            generateBtn.addEventListener('click', function() {
                const jsonText = jsonInput.value.trim();
                const language = targetLanguage.value;
                const name = className.value.trim() || 'Example';
                
                // 清空消息容器
                messageContainer.innerHTML = '';
                
                if (!jsonText) {
                    showMessage('请输入JSON数据', 'error');
                    return;
                }
                
                try {
                    // 验证JSON格式
                    const jsonObj = JSON.parse(jsonText);
                    
                    // 生成对应语言的代码
                    let code = '';
                    switch(language) {
                        case 'java':
                            code = generateJavaCode(jsonObj, name);
                            break;
                        case 'swift':
                            code = generateSwiftCode(jsonObj, name);
                            break;
                        case 'kotlin':
                            code = generateKotlinCode(jsonObj, name);
                            break;
                        case 'typescript':
                            code = generateTypeScriptCode(jsonObj, name);
                            break;
                        case 'csharp':
                            code = generateCSharpCode(jsonObj, name);
                            break;
                        case 'python':
                            code = generatePythonCode(jsonObj, name);
                            break;
                        default:
                            code = '未支持的语言类型';
                    }
                    
                    codeOutput.textContent = code;
                    showMessage('代码生成成功！', 'success');
                } catch (e) {
                    showMessage('JSON格式错误: ' + e.message, 'error');
                    codeOutput.textContent = 'JSON解析失败，请检查输入格式';
                }
            });
            
            // 显示消息函数
            function showMessage(message, type) {
                const messageDiv = document.createElement('div');
                messageDiv.className = type;
                messageDiv.textContent = message;
                messageContainer.appendChild(messageDiv);
                
                // 3秒后自动隐藏消息
                setTimeout(() => {
                    messageDiv.remove();
                }, 3000);
            }
            
            // 解析JSON对象的类型
            function getDataType(value) {
                if (value === null) return 'null';
                if (Array.isArray(value)) return 'array';
                return typeof value;
            }
            
            // 将属性名转换为驼峰命名
            function toCamelCase(str) {
                return str.replace(/_([a-z])/g, (match, letter) => letter.toUpperCase());
            }
            
            // 将属性名转换为大写命名
            function toPascalCase(str) {
                const camelCase = toCamelCase(str);
                return camelCase.charAt(0).toUpperCase() + camelCase.slice(1);
            }
            
            // Java代码生成
            function generateJavaCode(obj, className) {
                let code = `public class ${className} {\n`;
                const fields = [];
                
                for (const key in obj) {
                    if (obj.hasOwnProperty(key)) {
                        const value = obj[key];
                        const type = getDataType(value);
                        const fieldName = toCamelCase(key);
                        
                        let javaType;
                        switch(type) {
                            case 'string':
                                javaType = 'String';
                                break;
                            case 'number':
                                javaType = Number.isInteger(value) ? 'Integer' : 'Double';
                                break;
                            case 'boolean':
                                javaType = 'Boolean';
                                break;
                            case 'object':
                                if (value === null) {
                                    javaType = 'Object';
                                } else {
                                    javaType = toPascalCase(key);
                                }
                                break;
                            case 'array':
                                if (value.length > 0) {
                                    const elementType = getDataType(value[0]);
                                    switch(elementType) {
                                        case 'string':
                                            javaType = 'List<String>';
                                            break;
                                        case 'number':
                                            javaType = Number.isInteger(value[0]) ? 'List<Integer>' : 'List<Double>';
                                            break;
                                        case 'boolean':
                                            javaType = 'List<Boolean>';
                                            break;
                                        default:
                                            javaType = 'List<Object>';
                                    }
                                } else {
                                    javaType = 'List<Object>';
                                }
                                break;
                            default:
                                javaType = 'Object';
                        }
                        
                        fields.push({ name: fieldName, type: javaType });
                        code += `    private ${javaType} ${fieldName};\n`;
                    }
                }
                
                // 生成构造函数
                code += `\n    public ${className}() {}\n`;
                
                // 生成getter和setter方法
                fields.forEach(field => {
                    const methodName = toPascalCase(field.name);
                    
                    // Getter
                    code += `\n    public ${field.type} get${methodName}() {\n`;
                    code += `        return this.${field.name};\n`;
                    code += `    }\n`;
                    
                    // Setter
                    code += `\n    public void set${methodName}(${field.type} ${field.name}) {\n`;
                    code += `        this.${field.name} = ${field.name};\n`;
                    code += `    }\n`;
                });
                
                code += `}\n`;
                return code;
            }
            
            // Swift代码生成
            function generateSwiftCode(obj, className) {
                let code = `struct ${className}: Codable {\n`;
                
                for (const key in obj) {
                    if (obj.hasOwnProperty(key)) {
                        const value = obj[key];
                        const type = getDataType(value);
                        const fieldName = key;
                        
                        let swiftType;
                        switch(type) {
                            case 'string':
                                swiftType = 'String';
                                break;
                            case 'number':
                                swiftType = Number.isInteger(value) ? 'Int' : 'Double';
                                break;
                            case 'boolean':
                                swiftType = 'Bool';
                                break;
                            case 'object':
                                if (value === null) {
                                    swiftType = 'Any?';
                                } else {
                                    swiftType = toPascalCase(key);
                                }
                                break;
                            case 'array':
                                if (value.length > 0) {
                                    const elementType = getDataType(value[0]);
                                    switch(elementType) {
                                        case 'string':
                                            swiftType = '[String]';
                                            break;
                                        case 'number':
                                            swiftType = Number.isInteger(value[0]) ? '[Int]' : '[Double]';
                                            break;
                                        case 'boolean':
                                            swiftType = '[Bool]';
                                            break;
                                        default:
                                            swiftType = '[Any]';
                                    }
                                } else {
                                    swiftType = '[Any]';
                                }
                                break;
                            default:
                                swiftType = 'Any?';
                        }
                        
                        code += `    let ${fieldName}: ${swiftType}\n`;
                    }
                }
                
                code += `}\n`;
                return code;
            }
            
            // Kotlin代码生成
            function generateKotlinCode(obj, className) {
                let code = `data class ${className}(\n`;
                const fields = [];
                
                let index = 0;
                for (const key in obj) {
                    if (obj.hasOwnProperty(key)) {
                        const value = obj[key];
                        const type = getDataType(value);
                        const fieldName = toCamelCase(key);
                        
                        let kotlinType;
                        switch(type) {
                            case 'string':
                                kotlinType = 'String';
                                break;
                            case 'number':
                                kotlinType = Number.isInteger(value) ? 'Int' : 'Double';
                                break;
                            case 'boolean':
                                kotlinType = 'Boolean';
                                break;
                            case 'object':
                                if (value === null) {
                                    kotlinType = 'Any?';
                                } else {
                                    kotlinType = toPascalCase(key);
                                }
                                break;
                            case 'array':
                                if (value.length > 0) {
                                    const elementType = getDataType(value[0]);
                                    switch(elementType) {
                                        case 'string':
                                            kotlinType = 'List<String>';
                                            break;
                                        case 'number':
                                            kotlinType = Number.isInteger(value[0]) ? 'List<Int>' : 'List<Double>';
                                            break;
                                        case 'boolean':
                                            kotlinType = 'List<Boolean>';
                                            break;
                                        default:
                                            kotlinType = 'List<Any>';
                                    }
                                } else {
                                    kotlinType = 'List<Any>';
                                }
                                break;
                            default:
                                kotlinType = 'Any?';
                        }
                        
                        fields.push({ name: fieldName, type: kotlinType });
                        code += `    val ${fieldName}: ${kotlinType}${index < Object.keys(obj).length - 1 ? ',' : ''}\n`;
                        index++;
                    }
                }
                
                code += `)\n`;
                return code;
            }
            
            // TypeScript代码生成（改进版，支持嵌套对象）
            function generateTypeScriptCode(obj, interfaceName) {
                // 存储所有需要生成的接口定义
                const interfaces = [];
                
                // 递归处理对象，生成所有需要的接口
                function processObject(obj, name) {
                    // 检查是否已经处理过这个接口
                    if (interfaces.some(i => i.name === name)) {
                        return name;
                    }
                    
                    let code = `interface ${name} {\n`;
                    
                    for (const key in obj) {
                        if (obj.hasOwnProperty(key)) {
                            const value = obj[key];
                            const type = getDataType(value);
                            const fieldName = key;
                            
                            let tsType;
                            switch(type) {
                                case 'string':
                                    tsType = 'string';
                                    break;
                                case 'number':
                                    tsType = 'number';
                                    break;
                                case 'boolean':
                                    tsType = 'boolean';
                                    break;
                                case 'object':
                                    if (value === null) {
                                        tsType = 'any';
                                    } else {
                                        // 为嵌套对象创建新的接口名
                                        const nestedInterfaceName = toPascalCase(key);
                                        tsType = nestedInterfaceName;
                                        // 递归处理嵌套对象
                                        processObject(value, nestedInterfaceName);
                                    }
                                    break;
                                case 'array':
                                    if (value.length > 0) {
                                        const elementType = getDataType(value[0]);
                                        switch(elementType) {
                                            case 'string':
                                                tsType = 'string[]';
                                                break;
                                            case 'number':
                                                tsType = 'number[]';
                                                break;
                                            case 'boolean':
                                                tsType = 'boolean[]';
                                                break;
                                            case 'object':
                                                if (value[0] === null) {
                                                    tsType = 'any[]';
                                                } else {
                                                    // 为数组中的对象元素创建接口
                                                    const nestedInterfaceName = toPascalCase(key);
                                                    tsType = `${nestedInterfaceName}[]`;
                                                    // 递归处理数组中的对象
                                                    processObject(value[0], nestedInterfaceName);
                                                }
                                                break;
                                            default:
                                                tsType = 'any[]';
                                        }
                                    } else {
                                        tsType = 'any[]';
                                    }
                                    break;
                                default:
                                    tsType = 'any';
                            }
                            
                            code += `    ${fieldName}: ${tsType};\n`;
                        }
                    }
                    
                    code += `}\n`;
                    
                    // 将接口添加到列表中
                    interfaces.push({
                        name: name,
                        code: code
                    });
                    
                    return name;
                }
                
                // 处理主对象
                processObject(obj, interfaceName);
                
                // 按依赖顺序排列接口（简单的实现，实际可能需要拓扑排序）
                // 这里我们只是确保主接口在最后
                let result = '';
                const mainInterface = interfaces.find(i => i.name === interfaceName);
                const otherInterfaces = interfaces.filter(i => i.name !== interfaceName);
                
                // 先添加其他接口
                otherInterfaces.forEach(i => {
                    result += i.code + '\n';
                });
                
                // 最后添加主接口
                if (mainInterface) {
                    result += mainInterface.code;
                }
                
                return result;
            }
            
            // C#代码生成
            function generateCSharpCode(obj, className) {
                let code = `public class ${className}\n{\n`;
                
                for (const key in obj) {
                    if (obj.hasOwnProperty(key)) {
                        const value = obj[key];
                        const type = getDataType(value);
                        const propertyName = toPascalCase(key);
                        
                        let csType;
                        switch(type) {
                            case 'string':
                                csType = 'string';
                                break;
                            case 'number':
                                csType = Number.isInteger(value) ? 'int' : 'double';
                                break;
                            case 'boolean':
                                csType = 'bool';
                                break;
                            case 'object':
                                if (value === null) {
                                    csType = 'object';
                                } else {
                                    csType = toPascalCase(key);
                                }
                                break;
                            case 'array':
                                if (value.length > 0) {
                                    const elementType = getDataType(value[0]);
                                    switch(elementType) {
                                        case 'string':
                                            csType = 'List<string>';
                                            break;
                                        case 'number':
                                            csType = Number.isInteger(value[0]) ? 'List<int>' : 'List<double>';
                                            break;
                                        case 'boolean':
                                            csType = 'List<bool>';
                                            break;
                                        default:
                                            csType = 'List<object>';
                                    }
                                } else {
                                    csType = 'List<object>';
                                }
                                break;
                            default:
                                csType = 'object';
                        }
                        
                        code += `    public ${csType} ${propertyName} { get; set; }\n`;
                    }
                }
                
                code += `}\n`;
                return code;
            }
            
            // Python代码生成
            function generatePythonCode(obj, className) {
                let code = `class ${className}:\n`;
                code += `    def __init__(self):\n`;
                
                const fieldDefaults = [];
                for (const key in obj) {
                    if (obj.hasOwnProperty(key)) {
                        const value = obj[key];
                        const fieldName = toCamelCase(key);
                        
                        let defaultValue;
                        const type = getDataType(value);
                        switch(type) {
                            case 'string':
                                defaultValue = `""`;
                                break;
                            case 'number':
                                defaultValue = '0';
                                break;
                            case 'boolean':
                                defaultValue = 'False';
                                break;
                            case 'object':
                                if (value === null) {
                                    defaultValue = 'None';
                                } else {
                                    defaultValue = 'None  # TODO: Define proper type';
                                }
                                break;
                            case 'array':
                                defaultValue = '[]';
                                break;
                            default:
                                defaultValue = 'None';
                        }
                        
                        fieldDefaults.push({ name: fieldName, default: defaultValue });
                        code += `        self.${fieldName} = ${defaultValue}\n`;
                    }
                }
                
                if (fieldDefaults.length === 0) {
                    code += `        pass\n`;
                }
                
                return code;
            }
        });
    </script>
</body>
</html>